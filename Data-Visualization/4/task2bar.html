<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/echarts-gl/dist/echarts-gl.min.js"></script>
	<script src="c:\Users\Pairman\Desktop\Data Visualization\4\task2_sumup_byprovbar.js"></script>
</head>

<title>
	COVID-19: Comfirmed Cases per Province by Date
</title>

<body style="background-color: #060a10" onclick="play()">
	<p align="center">
		<B style="color: #ffffff; font-size:18px; font-family: sans-serif">
			COVID-19: Comfirmed Cases per Province by
		</B>
		<br>
		<B id="title_updateTime" style="color: #ffffff; font-size:28px; font-family: sans-serif">
			
		</B>
		<div id="main">
		</div>
	</p>
</body>

<script type="text/javascript">
	document.getElementById('main').setAttribute('style', 'width: ' + (window.innerWidth - 28) .toString() + 'px; height: ' + (window.innerHeight - 108).toString()+ 'px;');
	var myChart = echarts.init(document.getElementById('main'));
	var played = 1;

	option = {
		backgroundColor: '#060a10',
		xAxis: {
			name: 'Province',
			type: 'category',
			axisLine: {
				lineStyle: {
					color: '#ffffff'
				}
			},
			axisLabel: {
				rotate: -45
			}
		},
		yAxis: {
			name: 'Confirmed Cases',
			type: 'value',
			axisLine: {
				lineStyle: {
					color: '#ffffff'
				}
			},
		},
		tooltip: {},
		visualMap: {
			show: false,
			is_piecewise: true,
			pieces: [
				{min: 0, max: 9, label: "0-9", color: '#00cc20'},
				{min: 10, max: 99, label: "10-99", color: '#77bb10'},
				{min: 100, max: 999, label: "100-999", color: '#b0dd00'},
				{min: 1000, max: 9999, label: "1000-9999", color: '#dbd000'},
				{min: 10000, max: 99999, label: "10000-99999", color: '#f28d00'},
				{min: 100000, max: 999999, label: "100000-999999", color: '#f50c00'},
				{min: 1000000, max: 9999999, label: "1000000-9999999", color: '#ff0000'},
			],
		},
		dataset: {
			source: data[1][1]
		},
		series: {
			type: 'bar',
			label: {
				show: true,
				color: '#aaaaaa',
				distance: 10,
				rotate: -45,
				position: 'top'
			},
			data: data[1][1]
		},
		animationDuration: 0,
		animationDurationUpdate: 160,
		animationEasing: 'linear',
		animationEasingUpdate: 'linear'
	};

	function play() {
		if (!played)
			return;
		played = 0;
		for (var i = 2; i < data.length; ++i) {
			(function (i) {
				setTimeout(function () {
					updateData(i);
				}, i * 160);
			})(i);
		}
		setTimeout(function () {
			played = 1;
		}, data.length * 160);
	}

	function updateData(i) {
		document.getElementById("title_updateTime").innerText = data[i][0];
		option.series.data = data[i][1];
		myChart.setOption(option);
	}

	play();
</script>